import * as React from 'react';
import styles from './LatestNews.module.scss';

import { WebPartContext } from '@microsoft/sp-webpart-base';
import { NewsItem, fetchLatestNewsData } from './Fetchdata/FetchData';
import { EventsItem, fetchLatestNewsData2 } from './Fetchdata2/FetchData2';

import { useEffect, useState } from 'react';


interface ILatestNewsProps {
    context: WebPartContext;

}

const LatestNews: React.FC<ILatestNewsProps> = (props: ILatestNewsProps) => {

    const [, setNewsData] = useState<NewsItem[]>([])



    const [events, setEvents] = React.useState<EventsItem[]>([]); // State to hold the fetched events
    const [currentIndex,] = React.useState(0); // State to track the current index

    // Fetch data on component mount
    React.useEffect(() => {
        async function fetchEvents() {
            try {
                const data = await fetchLatestNewsData2();
                setEvents(data);
            } catch (error) {
                console.error('Error fetching events:', error);
            }
        }
        fetchEvents();
    }, []);


    useEffect(() => {
        const fetchData = async () => {
            const data = await fetchLatestNewsData();
            setNewsData(data);
        };
        fetchData();
    }, []);





    return (
        <div className={styles.UpE_left}>
            <div className={styles.cardContainer}>
                {events.length > 0 && (
                    <div className={styles.card1}>
                        <div >
                            <svg width="142" height="44" viewBox="0 0 142 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="22" cy="22" r="22" fill="white" />
                                <g clip-path="url(#clip0_252_3)">
                                    <path d="M6 13.2839C6.02394 13.2342 6.05473 13.1812 6.07525 13.1314C6.29074 12.6044 6.79014 12.2762 7.34084 12.2961C7.91206 12.316 8.38409 12.6773 8.56196 13.2309C8.5859 13.3038 8.60984 13.38 8.64405 13.4861C8.7535 13.4497 8.8527 13.4198 8.95189 13.3834C13.2549 11.7061 17.7255 10.8906 22.3637 11.01C23.5301 11.0398 24.6965 11.1823 25.8594 11.2851C26.2323 11.3183 26.4238 11.5205 26.3759 11.7956C26.3315 12.074 26.0989 12.2066 25.726 12.1536C24.1047 11.9348 22.4731 11.842 20.8347 11.8818C16.7267 11.9812 12.776 12.7933 8.98268 14.3248C8.94505 14.338 8.91085 14.3579 8.84928 14.3844C9.49233 16.9666 10.1354 19.5455 10.7819 22.141C17.9273 19.6184 25.059 19.6151 32.2113 22.141C32.8544 19.5555 33.4974 16.9766 34.1541 14.348C33.3024 14.0496 32.4747 13.7148 31.6161 13.4695C30.3334 13.1049 29.0302 12.8 27.7339 12.4751C27.385 12.3889 27.2105 12.2033 27.2618 11.9447C27.3166 11.6663 27.5628 11.547 27.922 11.6166C30.0324 12.0243 32.0882 12.611 34.0823 13.3999C34.1644 13.4331 34.2499 13.453 34.3491 13.4861C34.3833 13.39 34.4107 13.3071 34.438 13.2276C34.657 12.548 35.3342 12.1735 36.0217 12.3458C36.7127 12.5182 37.1266 13.1679 36.9555 13.864C36.1757 17.0163 35.3889 20.1687 34.6022 23.3177C34.4278 24.0205 34.2533 24.7232 34.0823 25.4259C34.0276 25.6447 33.9044 25.8303 33.665 25.8237C33.5179 25.8204 33.3264 25.7242 33.2443 25.6115C33.169 25.5055 33.1759 25.3099 33.2101 25.1674C33.4666 24.1033 33.7368 23.0393 34.0002 21.9786C34.6775 19.2638 35.3547 16.549 36.0286 13.8342C36.1209 13.4596 36.0354 13.2541 35.772 13.1944C35.5258 13.1381 35.3513 13.2905 35.2624 13.6485C34.3457 17.3213 33.4324 20.9941 32.5157 24.6701C31.7016 27.9352 30.891 31.2002 30.0769 34.4653C30.0666 34.5117 30.0461 34.5581 30.0393 34.6078C29.9914 34.873 30.1009 35.0653 30.3266 35.115C30.5421 35.1647 30.7473 35.0288 30.8123 34.7802C30.9389 34.2962 31.0552 33.8123 31.1783 33.3283C31.688 31.2765 32.1942 29.228 32.7107 27.1761C32.7415 27.0468 32.7962 26.9076 32.8851 26.8115C33.0254 26.6557 33.2169 26.6325 33.4085 26.7386C33.6069 26.848 33.6787 27.0236 33.6274 27.2358C33.4427 27.9849 33.258 28.7374 33.0698 29.4865C32.6183 31.2997 32.1668 33.1129 31.7187 34.9261C31.5853 35.4664 31.2638 35.8376 30.696 35.9669C30.2035 36.0796 29.7759 35.9337 29.4373 35.5724C29.1123 35.2244 29.0576 34.8133 29.1671 34.3659C30.094 30.6533 31.0175 26.9441 31.9411 23.2315C31.9548 23.1752 31.965 23.1188 31.989 23.0094C24.994 20.5101 18.0196 20.5134 11.0042 23.0094C11.165 23.6625 11.3189 24.2856 11.4728 24.9088C12.2561 28.0612 13.0428 31.2102 13.8261 34.3625C14.0177 35.1316 13.6209 35.7912 12.8684 35.9669C12.1706 36.1293 11.4865 35.7083 11.2984 34.9758C10.9221 33.5073 10.5595 32.0356 10.1935 30.5638C10.1149 30.2522 10.2414 30.0169 10.498 29.9539C10.7784 29.8876 10.9974 30.0368 11.0794 30.3649C11.4454 31.8168 11.8046 33.2687 12.1672 34.7205C12.2493 35.0421 12.4784 35.1945 12.7247 35.0852C12.9949 34.9658 12.9881 34.7471 12.9265 34.5117C12.6597 33.4477 12.3929 32.3869 12.1295 31.3229C10.6758 25.4558 9.21527 19.5886 7.75472 13.7248C7.73419 13.6485 7.72051 13.5723 7.69657 13.4961C7.62474 13.2707 7.47082 13.1447 7.22112 13.1911C6.99195 13.2342 6.87223 13.443 6.9338 13.6916C7.09114 14.338 7.2519 14.9844 7.41267 15.6275C8.47302 19.8704 9.52996 24.1133 10.5903 28.3562C10.6143 28.4523 10.6485 28.5484 10.645 28.6446C10.6382 28.8733 10.5253 29.0423 10.279 29.0821C10.0088 29.1252 9.8207 29.0125 9.75571 28.7539C9.56758 28.0346 9.38972 27.312 9.21185 26.5927C8.16176 22.383 7.11166 18.1798 6.06499 13.9734C6.04789 13.9203 6.02052 13.8673 6 13.8143C6 13.6386 6 13.4629 6 13.2872V13.2839Z" fill="#00966C" />
                                    <path d="M24.994 15.8626C24.9222 16.4526 24.847 17.0393 24.7751 17.6293C24.7478 17.8614 24.7307 18.0967 24.6896 18.3287C24.6383 18.6204 24.4297 18.7796 24.1663 18.7431C23.9166 18.7066 23.7627 18.5144 23.7935 18.226C23.92 17.1089 24.0603 15.9951 24.1936 14.8781C24.2244 14.6261 24.2621 14.3742 24.286 14.1223C24.3099 13.8604 24.3715 13.6284 24.6862 13.5787C24.9975 13.529 25.1377 13.7212 25.2403 13.9665C25.5892 14.7886 25.9415 15.6073 26.2938 16.4294C26.3383 16.5321 26.3896 16.6349 26.4991 16.7343C26.5504 16.3333 26.6017 15.9322 26.653 15.5278C26.7077 15.1002 26.7488 14.6726 26.8172 14.2483C26.8651 13.9466 27.1079 13.7975 27.385 13.877C27.6518 13.9533 27.7339 14.1488 27.7031 14.4041C27.5868 15.3753 27.4671 16.3432 27.3508 17.3144C27.2995 17.7321 27.2447 18.1498 27.2003 18.5674C27.1729 18.8061 27.0703 18.9884 26.8172 19.0315C26.547 19.0779 26.3828 18.932 26.2836 18.6967C25.9107 17.8216 25.5311 16.9498 25.1582 16.0747C25.1274 16.0051 25.0967 15.9322 25.0659 15.8626C25.0419 15.8626 25.0214 15.8626 24.9975 15.8626H24.994Z" fill="#00966C" />
                                    <path d="M21.1152 14.3379V15.6274C21.5359 15.6274 21.9361 15.6274 22.3397 15.6274C22.692 15.6274 22.8973 15.7964 22.8939 16.0682C22.8904 16.3401 22.6852 16.5058 22.3295 16.5091C21.9293 16.5124 21.5291 16.5091 21.0947 16.5091V17.7986C21.5291 17.7986 21.9293 17.7986 22.3261 17.7986C22.6852 17.7986 22.887 17.9577 22.8904 18.2295C22.8904 18.5046 22.6886 18.6737 22.3363 18.677C21.8027 18.6803 21.2657 18.6836 20.7321 18.677C20.3627 18.6737 20.1882 18.5145 20.1848 18.1565C20.178 16.7577 20.178 15.3589 20.1848 13.96C20.1848 13.6153 20.3558 13.4595 20.7116 13.4595C21.2657 13.4562 21.8232 13.4562 22.3774 13.4595C22.6886 13.4595 22.8836 13.6253 22.8904 13.8805C22.9007 14.1457 22.6989 14.3313 22.3774 14.3379C21.9635 14.3446 21.553 14.3379 21.1118 14.3379H21.1152Z" fill="#00966C" />
                                    <path d="M17.8622 17.729C17.9717 16.8639 18.0709 16.0816 18.1701 15.296C18.2282 14.8319 18.283 14.3645 18.348 13.9005C18.389 13.6121 18.6045 13.443 18.861 13.4828C19.121 13.5226 19.2817 13.7381 19.2475 14.0231C19.0765 15.3921 18.9055 16.7578 18.7276 18.1235C18.6729 18.5445 18.4061 18.813 18.0298 18.8594C17.6331 18.9091 17.3252 18.74 17.1405 18.3456C16.5624 17.1092 15.9878 15.8728 15.4132 14.6364C15.2695 14.3281 15.3448 14.0762 15.6013 13.9635C15.8612 13.8508 16.0938 13.9601 16.2443 14.2784C16.7266 15.3093 17.2055 16.3435 17.6878 17.3744C17.7323 17.4705 17.7801 17.56 17.8657 17.729H17.8622Z" fill="#00966C" />
                                    <path d="M12.841 15.5712C12.9573 16.0021 13.0599 16.3866 13.1728 16.8076C13.5217 16.7247 13.8569 16.6419 14.1921 16.559C14.281 16.5391 14.3665 16.5126 14.4555 16.496C14.7359 16.443 14.9617 16.5689 15.0198 16.8043C15.0814 17.0496 14.9548 17.2617 14.6778 17.338C14.2742 17.454 13.8637 17.5501 13.4088 17.6694C13.5148 18.0738 13.6174 18.4716 13.7303 18.9059C14.1476 18.8031 14.541 18.707 14.9377 18.6108C15.2798 18.528 15.5158 18.6374 15.5808 18.9059C15.6458 19.1677 15.509 19.3666 15.1772 19.4528C14.6538 19.592 14.1271 19.7279 13.6003 19.8506C13.2378 19.9367 13.0462 19.824 12.9504 19.4727C12.5844 18.1236 12.2219 16.7745 11.8661 15.422C11.7772 15.0872 11.8935 14.895 12.2321 14.8055C12.7555 14.6663 13.2822 14.5337 13.809 14.4044C14.1476 14.3215 14.3939 14.4409 14.4623 14.706C14.5307 14.9613 14.3631 15.1767 14.0245 15.2662C13.638 15.369 13.2514 15.4618 12.8376 15.5679L12.841 15.5712Z" fill="#00966C" />
                                    <path d="M29.6014 15.3061C29.2764 15.2331 28.9822 15.1735 28.6915 15.1006C28.4008 15.0276 28.2434 14.8055 28.305 14.5636C28.37 14.315 28.6026 14.1757 28.8933 14.2387C29.7963 14.4376 30.6993 14.6398 31.5989 14.8486C31.9239 14.9249 32.0675 15.1403 31.9957 15.3989C31.9273 15.6475 31.7152 15.7602 31.4005 15.7005C31.1064 15.6442 30.8122 15.5779 30.4975 15.5083C30.282 16.4099 30.0734 17.2916 29.8613 18.1733C29.7826 18.5048 29.704 18.8396 29.6219 19.1711C29.5364 19.5258 29.3277 19.6849 29.0404 19.6219C28.7633 19.5622 28.6539 19.3203 28.7394 18.9623C29.0028 17.8485 29.2696 16.7381 29.5329 15.6243C29.5569 15.5315 29.5706 15.4353 29.5979 15.3061H29.6014Z" fill="#00966C" />
                                </g>
                                <path d="M59.096 22.652H68.456V24.862H59.096V22.652ZM59.33 30.738H69.938V33H56.73V14.8H69.574V17.062H59.33V30.738ZM77.1695 33L71.1375 19.22H73.7375L79.0935 31.7H77.8455L83.3055 19.22H85.7495L79.7175 33H77.1695ZM93.834 33.156C92.3607 33.156 91.0607 32.8527 89.934 32.246C88.8247 31.6393 87.958 30.8073 87.334 29.75C86.7274 28.6927 86.424 27.4793 86.424 26.11C86.424 24.7407 86.7187 23.5273 87.308 22.47C87.9147 21.4127 88.738 20.5893 89.778 20C90.8354 19.3933 92.0227 19.09 93.34 19.09C94.6747 19.09 95.8534 19.3847 96.876 19.974C97.8987 20.5633 98.696 21.3953 99.268 22.47C99.8574 23.5273 100.152 24.7667 100.152 26.188C100.152 26.292 100.143 26.4133 100.126 26.552C100.126 26.6907 100.117 26.8207 100.1 26.942H88.374V25.148H98.8L97.786 25.772C97.8034 24.888 97.6214 24.0993 97.24 23.406C96.8587 22.7127 96.33 22.1753 95.654 21.794C94.9954 21.3953 94.224 21.196 93.34 21.196C92.4734 21.196 91.702 21.3953 91.026 21.794C90.35 22.1753 89.8214 22.7213 89.44 23.432C89.0587 24.1253 88.868 24.9227 88.868 25.824V26.24C88.868 27.1587 89.076 27.982 89.492 28.71C89.9254 29.4207 90.5234 29.9753 91.286 30.374C92.0487 30.7727 92.924 30.972 93.912 30.972C94.7267 30.972 95.4634 30.8333 96.122 30.556C96.798 30.2787 97.3874 29.8627 97.89 29.308L99.268 30.92C98.644 31.648 97.864 32.2027 96.928 32.584C96.0094 32.9653 94.978 33.156 93.834 33.156ZM110.976 19.09C112.103 19.09 113.091 19.3067 113.94 19.74C114.807 20.1733 115.483 20.832 115.968 21.716C116.453 22.6 116.696 23.718 116.696 25.07V33H114.2V25.356C114.2 24.0213 113.871 23.016 113.212 22.34C112.571 21.664 111.661 21.326 110.482 21.326C109.598 21.326 108.827 21.4993 108.168 21.846C107.509 22.1927 106.998 22.704 106.634 23.38C106.287 24.056 106.114 24.8967 106.114 25.902V33H103.618V19.22H106.01V22.938L105.62 21.95C106.071 21.0487 106.764 20.3467 107.7 19.844C108.636 19.3413 109.728 19.09 110.976 19.09ZM126.047 33.156C124.661 33.156 123.586 32.7833 122.823 32.038C122.061 31.2927 121.679 30.2267 121.679 28.84V16.204H124.175V28.736C124.175 29.4813 124.357 30.0533 124.721 30.452C125.103 30.8507 125.64 31.05 126.333 31.05C127.113 31.05 127.763 30.8333 128.283 30.4L129.063 32.194C128.682 32.5233 128.223 32.766 127.685 32.922C127.165 33.078 126.619 33.156 126.047 33.156ZM119.339 21.274V19.22H128.127V21.274H119.339ZM136.033 33.156C134.889 33.156 133.797 33 132.757 32.688C131.734 32.376 130.928 31.9947 130.339 31.544L131.379 29.568C131.968 29.9667 132.696 30.3047 133.563 30.582C134.43 30.8593 135.314 30.998 136.215 30.998C137.376 30.998 138.208 30.8333 138.711 30.504C139.231 30.1747 139.491 29.7153 139.491 29.126C139.491 28.6927 139.335 28.3547 139.023 28.112C138.711 27.8693 138.295 27.6873 137.775 27.566C137.272 27.4447 136.709 27.3407 136.085 27.254C135.461 27.15 134.837 27.0287 134.213 26.89C133.589 26.734 133.017 26.526 132.497 26.266C131.977 25.9887 131.561 25.616 131.249 25.148C130.937 24.6627 130.781 24.0213 130.781 23.224C130.781 22.392 131.015 21.664 131.483 21.04C131.951 20.416 132.61 19.9393 133.459 19.61C134.326 19.2633 135.348 19.09 136.527 19.09C137.428 19.09 138.338 19.2027 139.257 19.428C140.193 19.636 140.956 19.9393 141.545 20.338L140.479 22.314C139.855 21.898 139.205 21.612 138.529 21.456C137.853 21.3 137.177 21.222 136.501 21.222C135.409 21.222 134.594 21.404 134.057 21.768C133.52 22.1147 133.251 22.5653 133.251 23.12C133.251 23.588 133.407 23.952 133.719 24.212C134.048 24.4547 134.464 24.6453 134.967 24.784C135.487 24.9227 136.059 25.044 136.683 25.148C137.307 25.2347 137.931 25.356 138.555 25.512C139.179 25.6507 139.742 25.85 140.245 26.11C140.765 26.37 141.181 26.734 141.493 27.202C141.822 27.67 141.987 28.294 141.987 29.074C141.987 29.906 141.744 30.6253 141.259 31.232C140.774 31.8387 140.089 32.3153 139.205 32.662C138.321 32.9913 137.264 33.156 136.033 33.156Z" fill="white" />
                                <defs>
                                    <clipPath id="clip0_252_3">
                                        <rect width="31" height="25" fill="white" transform="translate(6 11)" />
                                    </clipPath>
                                </defs>
                            </svg>


                            <img src={events[currentIndex].ImgUrl} alt={events[currentIndex].Event} style={{ width: '100%', height: '350px' }} />
                        </div>
                        <div className={styles.card1_content}>
                            <div className={styles.EvTitle}>
                                <p>{events[currentIndex].Event}</p>
                            </div>
                            <div className={styles.EvDescription}>
                                <p>{events[currentIndex].Desciption}</p>
                            </div>
                        </div>
                    </div>
                )}
            </div>
        </div>
    );
};

export default LatestNews;



