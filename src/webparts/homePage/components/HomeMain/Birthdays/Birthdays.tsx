import * as React from 'react';
import { useState, useEffect, useRef } from 'react';
import * as XLSX from 'xlsx';

export interface IFormData {
  Nom: string;
  Prenom: string;
  Birthday: Date;
}

const Birthdays: React.FC = () => {
  const [formEntries, setFormEntries] = useState<IFormData[]>([]);
  const [currentIndex, setCurrentIndex] = useState(0);
  const [isAnimating, setIsAnimating] = useState(false);
  const containerRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    fetchFormData();
  }, []);

  const fetchFormData = async () => {
    try {
      const formData = await readExcelFile();
      const filteredFormData = formData.filter(entry => isToday(entry.Birthday));
      setFormEntries(filteredFormData);
    } catch (error) {
      console.error('Error fetching form data:', error);
    }
  };

  const readExcelFile = async (): Promise<IFormData[]> => {
    try {
      const response = await fetch('https://cnexia.sharepoint.com/sites/CnexiaForEveryone/Shared%20Documents/query.xlsx');
      const data = await response.arrayBuffer();
      const workbook = XLSX.read(data, { type: 'array' });
      const sheetName = workbook.SheetNames[0];
      const worksheet = workbook.Sheets[sheetName];

      const rawData = XLSX.utils.sheet_to_json(worksheet, { header: 1, raw: true });

      const formData: IFormData[] = rawData
        .slice(1)
        .map((row: any) => ({
          Nom: row[0],
          Prenom: row[1],
          Birthday: parseDate(row[2]) as Date,
        }));

      return formData;
    } catch (error) {
      console.error('Error reading Excel file:', error);
      throw new Error('An error occurred while reading Excel file. Please try again.');
    }
  };

  const parseDate = (dateString: any): Date | string => {
    if (!dateString) return '';

    if (typeof dateString === 'number') {
      return new Date((dateString - (25567 + 1)) * 86400 * 1000);
    } else if (typeof dateString === 'string') {
      return new Date(dateString);
    } else {
      return dateString;
    }
  };

  const isToday = (someDate: Date): boolean => {
    const today = new Date();
    return someDate.getDate() === today.getDate() && someDate.getMonth() === today.getMonth();
  };

  const handleSeeMore = () => {
    if (isAnimating) return;
    setIsAnimating(true);

    setTimeout(() => {
      setCurrentIndex(prevIndex => (prevIndex + 5 < formEntries.length ? prevIndex + 5 : 0));
      setIsAnimating(false);
    }, 500); // Match this duration with the animation duration in CSS
  };

  interface UpArrowIconProps {
    width?: string;
    height?: string;
    style?: React.CSSProperties;
  }
  const UpArrowIcon: React.FC<UpArrowIconProps> = ({ width = '24px', height = '15px', style }) => (
    <svg width={width} height={height} viewBox="0 0 24 15" fill="none" xmlns="http://www.w3.org/2000/svg" style={style}>
      <path d="M2.33374 2.80078L12.2156 12.5838L21.9986 2.70187" stroke="#00966C" strokeWidth="4" strokeLinecap="round" strokeLinejoin="round" />
    </svg>
  );

  return (
    <div style={{ backgroundColor: '#fff', height: '100%', position: 'relative', overflow: 'hidden' }}>
      <div style={{ display: 'flex', alignItems: 'center', borderBottom: '1px solid #ccc', marginBottom: '10px', height: '50px', marginTop: '20px', marginLeft: '10px' }}>
        <svg width="190" height="40" viewBox="0 0 217 44" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="22" cy="22" r="22" fill="#00AB7B" />
          <path d="M57.73 29V10.8H65.894C67.9913 10.8 69.6033 11.2247 70.73 12.074C71.8567 12.906 72.42 14.05 72.42 15.506C72.42 16.494 72.1947 17.326 71.744 18.002C71.3107 18.678 70.7213 19.198 69.976 19.562C69.2307 19.926 68.4247 20.108 67.558 20.108L68.026 19.328C69.066 19.328 69.9847 19.51 70.782 19.874C71.5793 20.238 72.212 20.7753 72.68 21.486C73.148 22.1793 73.382 23.046 73.382 24.086C73.382 25.646 72.7927 26.8593 71.614 27.726C70.4527 28.5753 68.7193 29 66.414 29H57.73ZM60.33 26.894H66.31C67.7487 26.894 68.8493 26.6513 69.612 26.166C70.3747 25.6807 70.756 24.918 70.756 23.878C70.756 22.8207 70.3747 22.0493 69.612 21.564C68.8493 21.0787 67.7487 20.836 66.31 20.836H60.096V18.73H65.66C66.9773 18.73 68 18.4873 68.728 18.002C69.456 17.5167 69.82 16.7887 69.82 15.818C69.82 14.8473 69.456 14.1193 68.728 13.634C68 13.1487 66.9773 12.906 65.66 12.906H60.33V26.894ZM77.0437 29V15.22H79.5397V29H77.0437ZM78.2917 12.568C77.8064 12.568 77.3991 12.412 77.0697 12.1C76.7577 11.788 76.6017 11.4067 76.6017 10.956C76.6017 10.488 76.7577 10.098 77.0697 9.786C77.3991 9.474 77.8064 9.318 78.2917 9.318C78.7771 9.318 79.1757 9.474 79.4877 9.786C79.8171 10.0807 79.9817 10.4533 79.9817 10.904C79.9817 11.372 79.8257 11.7707 79.5137 12.1C79.2017 12.412 78.7944 12.568 78.2917 12.568ZM84.3055 29V15.22H86.6975V18.964L86.4635 18.028C86.8448 17.0747 87.4861 16.3467 88.3875 15.844C89.2888 15.3413 90.3981 15.09 91.7155 15.09V17.508C91.6115 17.4907 91.5075 17.482 91.4035 17.482C91.3168 17.482 91.2301 17.482 91.1435 17.482C89.8088 17.482 88.7515 17.8807 87.9715 18.678C87.1915 19.4753 86.8015 20.628 86.8015 22.136V29H84.3055ZM100.082 29.156C98.6957 29.156 97.621 28.7833 96.8584 28.038C96.0957 27.2927 95.7144 26.2267 95.7144 24.84V12.204H98.2104V24.736C98.2104 25.4813 98.3924 26.0533 98.7564 26.452C99.1377 26.8507 99.675 27.05 100.368 27.05C101.148 27.05 101.798 26.8333 102.318 26.4L103.098 28.194C102.717 28.5233 102.258 28.766 101.72 28.922C101.2 29.078 100.654 29.156 100.082 29.156ZM93.3744 17.274V15.22H102.162V17.274H93.3744ZM113.474 15.09C114.601 15.09 115.589 15.3067 116.438 15.74C117.305 16.1733 117.981 16.832 118.466 17.716C118.951 18.6 119.194 19.718 119.194 21.07V29H116.698V21.356C116.698 20.0213 116.369 19.016 115.71 18.34C115.069 17.664 114.159 17.326 112.98 17.326C112.096 17.326 111.325 17.4993 110.666 17.846C110.007 18.1927 109.496 18.704 109.132 19.38C108.785 20.056 108.612 20.8967 108.612 21.902V29H106.116V9.708H108.612V18.938L108.118 17.95C108.569 17.0487 109.262 16.3467 110.198 15.844C111.134 15.3413 112.226 15.09 113.474 15.09ZM129.507 29.156C128.173 29.156 126.977 28.8613 125.919 28.272C124.879 27.6827 124.056 26.8593 123.449 25.802C122.843 24.7447 122.539 23.514 122.539 22.11C122.539 20.706 122.843 19.484 123.449 18.444C124.056 17.3867 124.879 16.5633 125.919 15.974C126.977 15.3847 128.173 15.09 129.507 15.09C130.669 15.09 131.717 15.35 132.653 15.87C133.589 16.39 134.335 17.17 134.889 18.21C135.461 19.25 135.747 20.55 135.747 22.11C135.747 23.67 135.47 24.97 134.915 26.01C134.378 27.05 133.641 27.8387 132.705 28.376C131.769 28.896 130.703 29.156 129.507 29.156ZM129.715 26.972C130.582 26.972 131.362 26.7727 132.055 26.374C132.766 25.9753 133.321 25.412 133.719 24.684C134.135 23.9387 134.343 23.0807 134.343 22.11C134.343 21.122 134.135 20.2727 133.719 19.562C133.321 18.834 132.766 18.2707 132.055 17.872C131.362 17.4733 130.582 17.274 129.715 17.274C128.831 17.274 128.043 17.4733 127.349 17.872C126.656 18.2707 126.101 18.834 125.685 19.562C125.269 20.2727 125.061 21.122 125.061 22.11C125.061 23.0807 125.269 23.9387 125.685 24.684C126.101 25.412 126.656 25.9753 127.349 26.374C128.043 26.7727 128.831 26.972 129.715 26.972ZM134.421 29V25.282L134.577 22.084L134.317 18.886V9.708H136.813V29H134.421ZM150.09 29V26.088L149.96 25.542V20.576C149.96 19.5187 149.648 18.704 149.024 18.132C148.417 17.5427 147.499 17.248 146.268 17.248C145.453 17.248 144.656 17.3867 143.876 17.664C143.096 17.924 142.437 18.2793 141.9 18.73L140.86 16.858C141.571 16.286 142.42 15.8527 143.408 15.558C144.413 15.246 145.462 15.09 146.554 15.09C148.443 15.09 149.899 15.5493 150.922 16.468C151.945 17.3867 152.456 18.7907 152.456 20.68V29H150.09ZM145.566 29.156C144.543 29.156 143.642 28.9827 142.862 28.636C142.099 28.2893 141.51 27.8127 141.094 27.206C140.678 26.582 140.47 25.88 140.47 25.1C140.47 24.3547 140.643 23.6787 140.99 23.072C141.354 22.4653 141.935 21.98 142.732 21.616C143.547 21.252 144.639 21.07 146.008 21.07H150.376V22.864H146.112C144.864 22.864 144.023 23.072 143.59 23.488C143.157 23.904 142.94 24.4067 142.94 24.996C142.94 25.672 143.209 26.218 143.746 26.634C144.283 27.0327 145.029 27.232 145.982 27.232C146.918 27.232 147.733 27.024 148.426 26.608C149.137 26.192 149.648 25.5853 149.96 24.788L150.454 26.504C150.125 27.3187 149.544 27.9687 148.712 28.454C147.88 28.922 146.831 29.156 145.566 29.156ZM157.419 34.2C156.76 34.2 156.119 34.0873 155.495 33.862C154.871 33.654 154.334 33.342 153.883 32.926L154.949 31.054C155.296 31.3833 155.677 31.6347 156.093 31.808C156.509 31.9813 156.951 32.068 157.419 32.068C158.026 32.068 158.528 31.912 158.927 31.6C159.326 31.288 159.698 30.7333 160.045 29.936L160.903 28.038L161.163 27.726L166.571 15.22H169.015L162.333 30.378C161.934 31.3487 161.484 32.1113 160.981 32.666C160.496 33.2207 159.958 33.6107 159.369 33.836C158.78 34.0787 158.13 34.2 157.419 34.2ZM160.695 29.442L154.403 15.22H157.003L162.359 27.492L160.695 29.442ZM175.119 29.156C173.975 29.156 172.883 29 171.843 28.688C170.82 28.376 170.014 27.9947 169.425 27.544L170.465 25.568C171.054 25.9667 171.782 26.3047 172.649 26.582C173.515 26.8593 174.399 26.998 175.301 26.998C176.462 26.998 177.294 26.8333 177.797 26.504C178.317 26.1747 178.577 25.7153 178.577 25.126C178.577 24.6927 178.421 24.3547 178.109 24.112C177.797 23.8693 177.381 23.6873 176.861 23.566C176.358 23.4447 175.795 23.3407 175.171 23.254C174.547 23.15 173.923 23.0287 173.299 22.89C172.675 22.734 172.103 22.526 171.583 22.266C171.063 21.9887 170.647 21.616 170.335 21.148C170.023 20.6627 169.867 20.0213 169.867 19.224C169.867 18.392 170.101 17.664 170.569 17.04C171.037 16.416 171.695 15.9393 172.545 15.61C173.411 15.2633 174.434 15.09 175.613 15.09C176.514 15.09 177.424 15.2027 178.343 15.428C179.279 15.636 180.041 15.9393 180.631 16.338L179.565 18.314C178.941 17.898 178.291 17.612 177.615 17.456C176.939 17.3 176.263 17.222 175.587 17.222C174.495 17.222 173.68 17.404 173.143 17.768C172.605 18.1147 172.337 18.5653 172.337 19.12C172.337 19.588 172.493 19.952 172.805 20.212C173.134 20.4547 173.55 20.6453 174.053 20.784C174.573 20.9227 175.145 21.044 175.769 21.148C176.393 21.2347 177.017 21.356 177.641 21.512C178.265 21.6507 178.828 21.85 179.331 22.11C179.851 22.37 180.267 22.734 180.579 23.202C180.908 23.67 181.073 24.294 181.073 25.074C181.073 25.906 180.83 26.6253 180.345 27.232C179.859 27.8387 179.175 28.3153 178.291 28.662C177.407 28.9913 176.349 29.156 175.119 29.156Z" fill="black" />
          <g clip-path="url(#clip0_252_3)" filter="url(#filter0_d_252_3)">
            <path d="M8 32.653C10.2801 27.4734 12.5603 22.2938 14.8468 17.1142C15.2056 16.3017 16.1774 15.6792 17.3397 15.8971C17.7208 15.9687 18.0955 16.0807 18.5083 16.1835C18.8037 15.5267 19.4039 15.0847 19.9152 14.5742C20.5789 13.9143 21.3855 13.7182 22.2969 13.9516C22.5859 14.0263 22.8717 14.1073 23.2052 14.2006C23.0781 13.7524 22.9575 13.3446 22.8495 12.9369C22.5923 11.9688 23.1798 11.0599 24.1801 10.87C24.9518 10.7237 25.7679 11.1688 26.0284 11.919C26.2538 12.5696 26.4634 13.2263 26.619 13.8956C26.8 14.6769 26.5936 15.3866 26.0315 15.9749C25.7076 16.3142 25.3742 16.6441 25.028 16.9585C24.3675 17.5593 23.5926 17.7336 22.7256 17.5033C22.4367 17.4254 22.154 17.329 21.792 17.2138C22.027 17.7492 21.9698 18.3126 22.4557 18.7235C24.1547 20.1678 25.6219 21.8051 26.6889 23.7599C27.0477 24.4136 27.3272 25.1015 27.4415 25.8423C27.5273 26.3995 27.4225 26.9287 27.2161 27.4392C27.0287 27.903 26.6476 28.1831 26.184 28.3761C23.3989 29.5465 20.6202 30.7231 17.8383 31.8966C15.574 32.8522 13.3097 33.8079 11.0455 34.7604C9.64818 35.3487 8.49541 34.8164 8.04128 33.3845C8.03811 33.369 8.01588 33.3596 8.00635 33.3472C8.00635 33.1137 8.00635 32.8834 8.00635 32.6499L8 32.653ZM24.4342 27.9403C20.2359 26.0727 17.2 23.0658 15.2056 19.0223C15.1897 19.0534 15.1485 19.1406 15.1104 19.2277C14.4625 20.6907 13.8147 22.1568 13.1668 23.6198C11.8553 26.5832 10.5437 29.5434 9.24487 32.5098C9.15595 32.7122 9.09879 32.9674 9.13372 33.1791C9.24169 33.811 9.87683 34.0849 10.531 33.8079C13.5892 32.5192 16.6474 31.2274 19.7056 29.9356C21.2934 29.2664 22.8813 28.5971 24.4373 27.9403H24.4342ZM22.0333 19.788C22.0016 19.8223 21.9762 19.8441 21.9571 19.8721C21.5379 20.4573 20.9568 20.7032 20.2486 20.5787C19.5627 20.4573 19.1244 20.0277 18.9307 19.3678C18.7433 18.7266 18.5623 18.0822 18.3718 17.441C18.3527 17.3756 18.2892 17.2916 18.2257 17.2729C17.8192 17.1546 17.4095 16.999 16.9935 16.9554C16.2949 16.8838 16.044 17.1795 16.1297 17.8643C16.225 18.6145 16.5426 19.2838 16.9205 19.9281C18.0669 21.8922 19.6166 23.514 21.4046 24.9241C22.3731 25.6867 23.3989 26.3715 24.5866 26.7668C24.9581 26.8913 25.3646 26.9442 25.7584 26.966C26.1268 26.9878 26.311 26.8042 26.3554 26.44C26.419 25.9388 26.2538 25.4812 26.0728 25.0237C25.2535 25.4221 24.5961 25.3069 24.2119 24.7186C24.0372 24.4509 23.9832 24.1552 24.034 23.8471C24.1134 23.3801 24.4278 23.0844 24.8565 22.8852C24.0213 21.7397 23.0845 20.7187 22.0333 19.7911V19.788ZM20.2518 15.813C19.5785 16.2582 19.3213 16.806 19.4928 17.4379C19.6452 17.9951 19.8167 18.5492 19.9914 19.1032C20.0962 19.4363 20.3947 19.5981 20.7123 19.5141C21.0203 19.4332 21.1918 19.1312 21.1092 18.7951C21.0648 18.6145 21.0108 18.434 20.9568 18.2534C20.7218 17.4441 20.4868 16.6317 20.2518 15.813ZM24.793 15.6979C24.974 15.508 25.0979 15.3773 25.2217 15.2496C25.5393 14.9166 25.6536 14.5181 25.5425 14.0855C25.3869 13.4909 25.1995 12.9026 25.0121 12.3143C24.9105 12.0061 24.6152 11.8598 24.323 11.9377C24.0086 12.0248 23.8403 12.2894 23.9102 12.6194C23.9546 12.8279 24.0181 13.0334 24.0785 13.2388C24.3103 14.0357 24.5421 14.8294 24.793 15.6979ZM21.1251 14.9757C21.2331 15.315 21.3029 15.5734 21.3982 15.8224C21.4236 15.894 21.4998 15.9718 21.5697 15.9967C22.0778 16.1679 22.5859 16.3329 23.0972 16.4823C23.3513 16.557 23.6117 16.5445 23.8784 16.4076C23.78 16.1025 23.6942 15.8037 23.5863 15.5111C23.564 15.4551 23.4751 15.4022 23.4084 15.3804C22.9289 15.2403 22.4525 15.0878 21.9667 14.9851C21.7126 14.9321 21.4395 14.9757 21.1251 14.9757ZM25.8346 24.0587C25.8346 23.7381 25.5774 23.4797 25.2503 23.4829C24.9359 23.4829 24.6819 23.7319 24.6723 24.0369C24.6628 24.3638 24.9137 24.619 25.244 24.6221C25.5774 24.6284 25.8315 24.3824 25.8346 24.0587Z" fill="white" />
            <path d="M29.4961 16.9587C29.404 16.6754 29.3214 16.4326 29.2452 16.1898C28.9403 15.2435 29.1372 14.4124 29.8518 13.7027C30.1344 13.4226 30.4139 13.1424 30.7028 12.8685C31.3761 12.2366 32.1668 12.0281 33.0687 12.2709C33.6467 12.4265 34.2247 12.5915 34.7963 12.7689C35.6982 13.0459 36.1872 13.9269 35.9395 14.7984C35.695 15.6607 34.7963 16.1556 33.8785 15.9284C33.4657 15.8256 33.056 15.7073 32.5892 15.5828C32.6464 15.8038 32.6813 15.9906 32.7448 16.1711C33.1418 17.2917 32.8782 18.238 31.9826 19.0287C31.7445 19.2372 31.5349 19.4738 31.303 19.6886C30.6457 20.2924 29.8708 20.4854 29.0038 20.2675C28.4068 20.115 27.813 19.9376 27.2255 19.7508C26.4125 19.4925 25.9647 18.8014 26.0505 17.9765C26.1267 17.2326 26.7459 16.6287 27.5557 16.554C27.8098 16.5291 28.0797 16.5914 28.3338 16.6474C28.7117 16.7314 29.0832 16.8466 29.4993 16.9618L29.4961 16.9587ZM31.0966 14.0451C32.1097 14.3253 33.0973 14.5992 34.0849 14.87C34.4724 14.9759 34.7709 14.8327 34.8725 14.5058C34.9741 14.1852 34.7931 13.8988 34.4089 13.7837C33.8785 13.6249 33.345 13.4724 32.8147 13.3168C32.386 13.1922 31.9795 13.2358 31.6238 13.5097C31.4396 13.6498 31.2967 13.8397 31.0934 14.0451H31.0966ZM30.9093 18.5057C30.8775 18.4901 30.8489 18.4652 30.814 18.4559C29.8422 18.1851 28.8736 17.9143 27.9019 17.6435C27.8257 17.6217 27.7399 17.6092 27.6605 17.6155C27.3938 17.6341 27.1778 17.8334 27.1429 18.0855C27.1016 18.3719 27.2413 18.6209 27.5335 18.7112C28.0353 18.8699 28.5434 19.0069 29.0483 19.1532C29.8772 19.3928 30.398 19.2123 30.9093 18.4995V18.5057ZM31.7826 17.5843C31.7826 17.3166 31.827 17.0489 31.773 16.7999C31.6682 16.3206 31.5126 15.8536 31.3697 15.3836C31.3475 15.3151 31.2967 15.2249 31.2395 15.2031C30.9347 15.0972 30.6234 15.0132 30.2487 14.9011C30.2487 15.2031 30.217 15.4583 30.2582 15.7042C30.3059 15.975 30.4583 16.2272 30.4964 16.498C30.5917 17.1828 31.0014 17.5065 31.6682 17.5843C31.6778 17.5843 31.6873 17.5843 31.7857 17.5843H31.7826Z" fill="white" />
            <path d="M19.1498 8.14307C19.2451 8.28003 19.3245 8.35162 19.3594 8.44189C19.4896 8.77495 19.5881 9.12047 19.7342 9.4442C19.7913 9.57493 19.9215 9.69944 20.0486 9.77103C20.3185 9.91733 20.6138 10.0169 20.8869 10.157C20.9854 10.2068 21.1124 10.3251 21.1092 10.4091C21.1092 10.4963 20.9759 10.6053 20.8774 10.6551C20.6392 10.7796 20.3884 10.8947 20.1343 10.985C19.8993 11.0691 19.7627 11.206 19.6961 11.4426C19.604 11.7601 19.4833 12.0682 19.3563 12.3733C19.3213 12.4573 19.2165 12.5134 19.1435 12.5818C19.08 12.5134 18.9879 12.4573 18.9561 12.3764C18.8196 12.0371 18.7148 11.6854 18.5687 11.3492C18.5147 11.2247 18.3972 11.1033 18.2733 11.0379C17.9971 10.8885 17.6922 10.7827 17.4127 10.6395C17.3206 10.5928 17.1936 10.4776 17.2031 10.4123C17.2158 10.3189 17.327 10.2068 17.4254 10.1601C17.7081 10.0169 18.0098 9.91111 18.2892 9.76481C18.4036 9.70567 18.5147 9.58738 18.5655 9.47221C18.7116 9.13603 18.8196 8.78429 18.9529 8.445C18.9879 8.35473 19.0641 8.28003 19.1594 8.14307H19.1498Z" fill="white" />
            <path d="M27.6417 9.18585C27.6671 8.51038 28.2514 7.97499 28.9342 8.003C29.6075 8.02791 30.1537 8.59443 30.1378 9.2481C30.1219 9.92046 29.5312 10.4714 28.858 10.4465C28.1689 10.4216 27.6163 9.84887 27.6417 9.18585ZM28.8866 8.64734C28.569 8.64734 28.2959 8.92438 28.3023 9.23254C28.3086 9.54382 28.5881 9.8084 28.9056 9.79595C29.2169 9.78661 29.4741 9.52825 29.4773 9.22632C29.4773 8.91504 29.2041 8.64423 28.8866 8.64734Z" fill="white" />
            <path d="M30.9348 22.6799C31.624 22.683 32.1797 23.2371 32.1702 23.9125C32.1606 24.5787 31.6112 25.1109 30.9285 25.1109C30.2362 25.1109 29.6741 24.5631 29.6773 23.8907C29.6773 23.2153 30.2394 22.6737 30.9348 22.6768V22.6799ZM30.9158 24.4635C31.2429 24.4666 31.5096 24.2145 31.5128 23.897C31.5128 23.5826 31.2429 23.3242 30.919 23.3242C30.6014 23.3242 30.3473 23.5701 30.341 23.8783C30.3314 24.1989 30.5887 24.4573 30.9158 24.4604V24.4635Z" fill="white" />
            <path d="M34.4852 22.7297C34.4122 22.627 34.355 22.5741 34.3296 22.5056C34.2407 22.2815 34.1835 22.0418 34.0756 21.8301C34.0089 21.6994 33.8914 21.578 33.7643 21.5002C33.5802 21.3881 33.3674 21.3258 33.1737 21.2262C33.1102 21.1951 33.0339 21.1142 33.0339 21.0581C33.0339 20.999 33.107 20.9181 33.1705 20.8869C33.3706 20.7842 33.5929 20.7157 33.7866 20.6037C33.9009 20.5383 34.012 20.4263 34.066 20.3111C34.1772 20.0776 34.2439 19.8255 34.3423 19.5858C34.3645 19.5298 34.4344 19.4582 34.4852 19.4551C34.536 19.4551 34.6091 19.5267 34.6313 19.5827C34.7298 19.8224 34.7964 20.0745 34.9076 20.308C34.9616 20.4231 35.0695 20.5352 35.1839 20.6006C35.3871 20.7189 35.6158 20.7904 35.8222 20.8994C35.9968 20.9897 36 21.1266 35.8222 21.2169C35.6126 21.3258 35.3839 21.3943 35.1807 21.5126C35.0664 21.578 34.9616 21.69 34.9044 21.8052C34.7964 22.0293 34.7298 22.2721 34.6345 22.5056C34.6091 22.5741 34.5519 22.6301 34.482 22.7328L34.4852 22.7297Z" fill="white" />
            <path d="M34.0406 8.73456C34.4756 8.72833 34.8281 9.05828 34.8408 9.48162C34.8536 9.8925 34.4979 10.2505 34.066 10.2567C33.6341 10.2629 33.2752 9.92674 33.2689 9.50652C33.2625 9.0863 33.6055 8.73767 34.0406 8.73145V8.73456Z" fill="white" />
            <path d="M28.8134 12.1557C28.8198 12.3767 28.6356 12.5728 28.4101 12.5821C28.1846 12.5915 27.9814 12.414 27.9687 12.193C27.9528 11.9627 28.1497 11.7572 28.3879 11.751C28.6102 11.7479 28.8102 11.9347 28.8166 12.1557H28.8134Z" fill="white" />
            <path d="M12.9922 26.7792C12.9922 26.7605 12.9922 26.7294 13.0049 26.7076C13.2685 26.1037 13.5194 25.4905 13.8083 24.896C13.9258 24.6563 14.2402 24.6096 14.4816 24.7279C14.7198 24.8431 14.8595 25.1139 14.761 25.3567C14.5292 25.9263 14.2783 26.4897 14.0179 27.05C13.9036 27.2897 13.6432 27.3768 13.3923 27.3021C13.1541 27.2337 12.9922 27.0189 12.9954 26.7792H12.9922Z" fill="white" />
            <path d="M15.8248 22.9785C15.6787 23.2618 15.5644 23.5668 15.3802 23.819C15.2373 24.0151 14.9832 24.0182 14.7578 23.903C14.5418 23.791 14.418 23.5419 14.491 23.3147C14.5641 23.0968 14.6562 22.8789 14.7673 22.6766C14.888 22.4556 15.1452 22.3684 15.377 22.4338C15.6184 22.5023 15.774 22.7077 15.8248 22.9785Z" fill="white" />
          </g>
          <defs>
            <filter id="filter0_d_252_3" x="4" y="8" width="36" height="35" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
              <feOffset dy="4" />
              <feGaussianBlur stdDeviation="2" />
              <feComposite in2="hardAlpha" operator="out" />
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0" />
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_252_3" />
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_252_3" result="shape" />
            </filter>
            <clipPath id="clip0_252_3">
              <rect width="28" height="27" fill="white" transform="translate(8 8)" />
            </clipPath>
          </defs>
        </svg>
      </div>
      <div className={`container ${isAnimating ? 'animating' : ''}`} ref={containerRef} style={{ backgroundImage: 'url(\'data:image/svg+xml,<svg width="292" height="281"  fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(%23clip0_286_323)"><path d="M0 256.574C23.7786 202.667 47.5572 148.761 71.4021 94.8545C75.1444 86.3993 85.2784 79.9201 97.3996 82.1878C101.374 82.9329 105.282 84.0992 109.587 85.1682C112.667 78.3328 118.926 73.7326 124.258 68.4197C131.18 61.5518 139.592 59.5109 149.097 61.9405C152.11 62.718 155.091 63.5603 158.568 64.5322C157.244 59.8672 155.985 55.6234 154.859 51.3796C152.176 41.3045 158.303 31.845 168.735 29.8688C176.783 28.3462 185.294 32.9788 188.01 40.7862C190.361 47.5569 192.547 54.3924 194.17 61.3574C196.058 69.4887 193.905 76.8749 188.043 82.9977C184.665 86.5289 181.188 89.9628 177.578 93.2348C170.689 99.4871 162.609 101.301 153.567 98.904C150.554 98.0941 147.606 97.0898 143.831 95.8912C146.282 101.463 145.685 107.327 150.752 111.603C168.47 126.635 183.771 143.675 194.898 164.019C198.641 170.822 201.555 177.982 202.747 185.692C203.642 191.491 202.549 196.998 200.396 202.311C198.442 207.138 194.468 210.054 189.633 212.062C160.588 224.243 131.61 236.488 102.599 248.702C78.9861 258.647 55.373 268.592 31.76 278.506C17.1882 284.628 5.16638 279.089 0.430532 264.187C0.397414 264.025 0.165589 263.928 0.0662357 263.798C0.0662357 261.368 0.0662357 258.971 0.0662357 256.541L0 256.574ZM171.385 207.527C127.603 188.089 95.9424 156.795 75.1444 114.713C74.9788 115.037 74.5483 115.944 74.1508 116.851C67.3948 132.077 60.6388 147.336 53.8827 162.561C40.2051 193.402 26.5274 224.21 12.9822 255.083C12.0549 257.189 11.4588 259.846 11.8231 262.049C12.9491 268.625 19.5726 271.476 26.3949 268.592C58.2874 255.181 90.1799 241.736 122.072 228.292C138.631 221.327 155.19 214.362 171.418 207.527H171.385ZM146.348 122.682C146.017 123.039 145.752 123.266 145.553 123.557C141.181 129.647 135.121 132.207 127.736 130.911C120.582 129.647 116.012 125.177 113.992 118.309C112.038 111.635 110.15 104.93 108.163 98.2561C107.964 97.5758 107.302 96.7011 106.639 96.5067C102.4 95.2757 98.1282 93.6559 93.7897 93.2024C86.5038 92.4573 83.8875 95.5349 84.7817 102.662C85.7752 110.469 89.087 117.434 93.028 124.14C104.984 144.582 121.145 161.46 139.79 176.135C149.891 184.072 160.588 191.199 172.974 195.314C176.849 196.609 181.088 197.16 185.195 197.387C189.037 197.614 190.957 195.702 191.421 191.912C192.083 186.696 190.361 181.934 188.474 177.172C179.929 181.319 173.074 180.12 169.067 173.997C167.245 171.211 166.682 168.134 167.212 164.926C168.04 160.067 171.319 156.989 175.79 154.916C167.08 142.994 157.31 132.369 146.348 122.715V122.682ZM127.769 81.3132C120.748 85.9457 118.065 91.6474 119.853 98.2237C121.443 104.023 123.231 109.789 125.053 115.555C126.146 119.022 129.259 120.706 132.571 119.832C135.783 118.989 137.572 115.847 136.71 112.348C136.247 110.469 135.684 108.59 135.121 106.711C132.67 98.2885 130.219 89.8332 127.769 81.3132ZM175.127 80.1145C177.015 78.1384 178.306 76.7778 179.598 75.4495C182.91 71.9832 184.102 67.8366 182.943 63.3336C181.32 57.146 179.366 51.0232 177.412 44.9004C176.353 41.6933 173.273 40.1707 170.226 40.9805C166.947 41.8876 165.192 44.6413 165.92 48.0752C166.384 50.2457 167.046 52.3838 167.676 54.5219C170.093 62.8152 172.511 71.0761 175.127 80.1145ZM136.876 72.5987C138.002 76.1298 138.731 78.8187 139.724 81.4103C139.989 82.1554 140.784 82.9653 141.513 83.2245C146.811 85.0063 152.11 86.7232 157.442 88.2782C160.092 89.0557 162.807 88.9261 165.589 87.5007C164.563 84.3259 163.668 81.216 162.542 78.1708C162.311 77.5876 161.383 77.0369 160.688 76.8102C155.687 75.3523 150.719 73.765 145.652 72.6959C143.003 72.1452 140.155 72.5987 136.876 72.5987ZM185.99 167.129C185.99 163.793 183.307 161.104 179.896 161.136C176.617 161.136 173.968 163.728 173.869 166.903C173.769 170.304 176.386 172.96 179.83 172.993C183.307 173.058 185.957 170.498 185.99 167.129Z" fill="%2300966C" fill-opacity="0.07"/><path d="M224.175 93.2347C223.214 90.2867 222.353 87.7598 221.558 85.233C218.379 75.3847 220.432 66.7351 227.884 59.3488C230.831 56.4332 233.746 53.5176 236.759 50.6668C243.78 44.0905 252.027 41.92 261.432 44.4468C267.46 46.0666 273.487 47.7836 279.448 49.6301C288.854 52.5134 293.954 61.6813 291.371 70.7521C288.821 79.7257 279.448 84.8766 269.877 82.5117C265.572 81.4427 261.3 80.2117 256.431 78.9158C257.028 81.2159 257.392 83.1597 258.054 85.0386C262.194 96.701 259.445 106.549 250.106 114.778C247.622 116.948 245.436 119.41 243.019 121.646C236.163 127.93 228.083 129.939 219.041 127.671C212.815 126.084 206.622 124.237 200.495 122.294C192.017 119.605 187.348 112.413 188.242 103.828C189.037 96.0855 195.495 89.8008 203.94 89.0233C206.589 88.7641 209.404 89.412 212.053 89.9951C215.995 90.8698 219.869 92.0685 224.208 93.2671L224.175 93.2347ZM240.866 62.9124C251.431 65.828 261.73 68.6788 272.03 71.4972C276.07 72.5987 279.183 71.1085 280.243 67.7069C281.303 64.3702 279.415 61.3898 275.408 60.1911C269.877 58.5389 264.313 56.9516 258.783 55.3318C254.312 54.036 250.073 54.4895 246.364 57.3403C244.443 58.7981 242.952 60.7743 240.833 62.9124H240.866ZM238.912 109.335C238.581 109.173 238.283 108.914 237.919 108.817C227.784 105.999 217.684 103.18 207.549 100.362C206.755 100.135 205.86 100.005 205.033 100.07C202.251 100.265 199.999 102.338 199.634 104.962C199.204 107.942 200.661 110.534 203.708 111.473C208.94 113.126 214.239 114.551 219.505 116.074C228.149 118.568 233.58 116.689 238.912 109.271V109.335ZM248.019 99.7462C248.019 96.9602 248.483 94.1742 247.92 91.5825C246.827 86.5936 245.204 81.7342 243.714 76.8425C243.482 76.1298 242.952 75.1903 242.356 74.9636C239.177 73.8621 235.931 72.9874 232.024 71.8212C232.024 74.9636 231.692 77.62 232.123 80.1793C232.62 82.9977 234.209 85.6217 234.607 88.4401C235.6 95.5672 239.872 98.9363 246.827 99.7462C246.927 99.7462 247.026 99.7462 248.053 99.7462H248.019Z" fill="%2300966C" fill-opacity="0.07"/><path d="M116.277 1.49017C117.27 2.91558 118.098 3.66068 118.463 4.60016C119.82 8.06649 120.847 11.6624 122.37 15.0316C122.967 16.3922 124.324 17.688 125.649 18.4331C128.464 19.9557 131.544 20.9924 134.392 22.4502C135.419 22.9685 136.744 24.1995 136.71 25.0742C136.71 25.9813 135.319 27.1151 134.293 27.6335C131.809 28.9293 129.193 30.1279 126.543 31.0674C124.093 31.9421 122.668 33.3675 121.973 35.8296C121.013 39.1339 119.754 42.3411 118.429 45.5159C118.065 46.3906 116.972 46.9737 116.21 47.6864C115.548 46.9737 114.588 46.3906 114.257 45.5483C112.832 42.0172 111.74 38.3564 110.216 34.8577C109.653 33.5619 108.428 32.2985 107.136 31.6181C104.255 30.0632 101.076 28.9617 98.1613 27.4715C97.2009 26.9856 95.8761 25.7869 95.9755 25.1066C96.108 24.1347 97.2671 22.9685 98.2937 22.4826C101.241 20.9924 104.387 19.8909 107.302 18.3683C108.494 17.7528 109.653 16.5218 110.183 15.3231C111.706 11.8244 112.832 8.16368 114.223 4.63255C114.588 3.69308 115.383 2.91558 116.376 1.49017H116.277Z" fill="%2300966C" fill-opacity="0.07"/><path d="M204.834 12.3428C205.099 5.31292 211.192 -0.259135 218.313 0.0324262C225.334 0.291592 231.03 6.1876 230.864 12.9907C230.699 19.9882 224.539 25.7222 217.518 25.463C210.331 25.2039 204.569 19.2431 204.834 12.3428ZM217.816 6.73833C214.504 6.73833 211.656 9.62154 211.722 12.8287C211.788 16.0683 214.703 18.8219 218.015 18.6923C221.26 18.5951 223.943 15.9063 223.976 12.7639C223.976 9.52436 221.128 6.70593 217.816 6.73833Z" fill="%2300966C" fill-opacity="0.07"/><path d="M239.177 152.778C246.364 152.81 252.159 158.577 252.06 165.607C251.961 172.539 246.231 178.079 239.111 178.079C231.891 178.079 226.029 172.377 226.062 165.38C226.062 158.35 231.924 152.713 239.177 152.746V152.778ZM238.978 171.341C242.389 171.373 245.171 168.749 245.205 165.445C245.205 162.173 242.389 159.484 239.011 159.484C235.7 159.484 233.05 162.043 232.984 165.25C232.885 168.587 235.567 171.276 238.978 171.308V171.341Z" fill="%2300966C" fill-opacity="0.07"/><path d="M276.203 153.296C275.441 152.227 274.845 151.677 274.58 150.964C273.653 148.631 273.057 146.137 271.931 143.934C271.235 142.573 270.01 141.31 268.685 140.5C266.764 139.334 264.545 138.686 262.525 137.649C261.863 137.325 261.068 136.483 261.068 135.9C261.068 135.284 261.83 134.442 262.492 134.118C264.578 133.049 266.897 132.336 268.917 131.17C270.109 130.49 271.268 129.324 271.831 128.125C272.99 125.695 273.686 123.071 274.712 120.577C274.944 119.994 275.673 119.248 276.203 119.216C276.733 119.216 277.494 119.961 277.726 120.544C278.753 123.039 279.448 125.663 280.607 128.092C281.17 129.291 282.296 130.457 283.489 131.138C285.608 132.369 287.993 133.114 290.145 134.248C291.967 135.187 292 136.613 290.145 137.552C287.96 138.686 285.575 139.399 283.456 140.63C282.263 141.31 281.17 142.476 280.574 143.675C279.448 146.007 278.753 148.534 277.759 150.964C277.494 151.677 276.898 152.26 276.17 153.329L276.203 153.296Z" fill="%2300966C" fill-opacity="0.07"/><path d="M271.566 7.64537C276.104 7.58058 279.78 11.0145 279.912 15.4203C280.045 19.6966 276.335 23.4221 271.831 23.4869C267.327 23.5516 263.585 20.0529 263.519 15.6795C263.452 11.3061 267.029 7.67777 271.566 7.61298V7.64537Z" fill="%2300966C" fill-opacity="0.07"/><path d="M217.054 43.2482C217.121 45.5483 215.2 47.5892 212.848 47.6864C210.497 47.7836 208.377 45.9371 208.245 43.637C208.079 41.2397 210.133 39.1016 212.617 39.0368C214.935 39.0044 217.021 40.9481 217.087 43.2482H217.054Z" fill="%2300966C" fill-opacity="0.07"/><path d="M52.0613 195.443C52.0613 195.249 52.0613 194.925 52.1938 194.698C54.9425 188.413 57.5588 182.031 60.5726 175.844C61.7979 173.349 65.0766 172.863 67.5935 174.094C70.0774 175.293 71.5346 178.111 70.5079 180.638C68.0903 186.567 65.474 192.43 62.7583 198.261C61.5661 200.756 58.8504 201.663 56.2341 200.886C53.7503 200.173 52.0613 197.938 52.0944 195.443H52.0613Z" fill="%2300966C" fill-opacity="0.07"/><path d="M81.6024 155.888C80.0789 158.836 78.8867 162.011 76.9659 164.635C75.4756 166.676 72.8261 166.708 70.4748 165.509C68.2228 164.343 66.9312 161.752 67.6929 159.387C68.4546 157.119 69.415 154.851 70.5741 152.746C71.8326 150.445 74.5151 149.538 76.9327 150.219C79.4497 150.931 81.0725 153.069 81.6024 155.888Z" fill="%2300966C" fill-opacity="0.07"/></g><defs><clipPath id="clip0_286_323"><rect width="292" height="281" fill="white"/></clipPath></defs></svg>\')' }}>
        {formEntries.slice(currentIndex, currentIndex + 5).map((entry, index) => (
          <div key={index} className="card-wrapper" style={{ display: 'flex', marginBottom: '10px', transition: 'transform 0.5s' }}>
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M4 16.5V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V16.5M3 14V13C3 12.4696 3.21071 11.9609 3.58579 11.5858C3.96086 11.2107 4.46957 11 5 11H19C19.5304 11 20.0391 11.2107 20.4142 11.5858C20.7893 11.9609 21 12.4696 21 13V14M12 8V11M12 8C13.262 8 14 7.032 14 5.375C14 3.718 12 2 12 2C12 2 10 3.718 10 5.375C10 7.032 10.738 8 12 8Z" stroke="#00966C" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M3 14C3 14.7956 3.31607 15.5587 3.87868 16.1213C4.44129 16.6839 5.20435 17 6 17C6.79565 17 7.55871 16.6839 8.12132 16.1213C8.68393 15.5587 9 14.7956 9 14C9 14.7956 9.31607 15.5587 9.87868 16.1213C10.4413 16.6839 11.2044 17 12 17C12.7956 17 13.5587 16.6839 14.1213 16.1213C14.6839 15.5587 15 14.7956 15 14C15 14.7956 15.3161 15.5587 15.8787 16.1213C16.4413 16.6839 17.2044 17 18 17C18.7956 17 19.5587 16.6839 20.1213 16.1213C20.6839 15.5587 21 14.7956 21 14" stroke="#00966C" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <div style={{ width: '1px' }}></div>
            <div className="card" style={{ minWidth: '300px', border: '1px solid #ccc', borderRadius: '5px', padding: '10px', backgroundColor: 'transparent', marginLeft: '10px', fontFamily: 'Montserrat, sans-serif' }}>
              <div style={{ fontSize: '16px', fontWeight: 'bold', marginBottom: '5px', color: '#044123', fontFamily: 'Montserrat' }}>{entry.Nom} {entry.Prenom}</div>
              <div style={{ fontSize: '16px', color: '#044123', fontFamily: 'Montserrat' }}>We wish you all a happy birthday!</div>
            </div>
          </div>
        ))}
      </div>
      {formEntries.length > 5 && (
        <div style={{ position: 'absolute', bottom: '0', width: '100%', textAlign: 'center', boxSizing: 'border-box' }}>
          <button onClick={handleSeeMore} style={{
            padding: '10px 0',
            backgroundColor: 'rgba(255, 255, 255, 0.5)',
            color: '#000',
            border: '1px solid #f2f2f2 ',
            borderRadius: '0',
            cursor: 'pointer',
            fontFamily: 'Montserrat, sans-serif',
            width: '100%',
            boxSizing: 'border-box'
          }}>
            <UpArrowIcon style={{ width: '20px', height: '20px', marginRight: '5px' }} />
          </button>
        </div>

      )}
      <style>{`
        .container {
          height: 100%;
          overflow: hidden;
          position: relative;
        }
        .card-wrapper {
          transition: transform 0.5s;
        }
        .container.animating .card-wrapper {
          transform: translateY(-100%);
        }
      `}</style>
    </div>
  );
};

export default Birthdays;
